<!DOCTYPE html>
<html>
<head>
    <title>Citation Test</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Citation Test Page</h1>
    
    <p>InterMT Paper: <strong><span class='show_paper_citations' data='o23sDqkAAAAJ:roLk4NBRz8UC'></span></strong></p>
    <p>Language Models Resist Alignment: <strong><span class='show_paper_citations' data='o23sDqkAAAAJ:IjCSPb-OGe4C'></span></strong></p>
    <p>PKU-SafeRLHF: <strong><span class='show_paper_citations' data='o23sDqkAAAAJ:WF5omc3nYNoC'></span></strong></p>
    <p>Aligner: <strong><span class='show_paper_citations' data='o23sDqkAAAAJ:Tyk-4Ss8FVUC'></span></strong></p>
    <p>BeaverTails: <strong><span class='show_paper_citations' data='o23sDqkAAAAJ:u5HHmVD_uO8C'></span></strong></p>
    
    <script>
        $(document).ready(function () {
            console.log('Test page: Google Scholar script starting...');
            
            var dataUrl = "/google-scholar-stats/gs_data.json";
            console.log('Fetching data from:', dataUrl);
            
            $.getJSON(dataUrl)
                .done(function (data) {
                    console.log('Data loaded successfully:', data);
                    
                    var citationEles = document.getElementsByClassName('show_paper_citations');
                    console.log('Found citation elements:', citationEles.length);
                    
                    Array.prototype.forEach.call(citationEles, function(element) {
                        var paperId = element.getAttribute('data');
                        console.log('Processing paper ID:', paperId);
                        
                        if (data['publications'] && data['publications'][paperId]) {
                            var numCitations = data['publications'][paperId]['num_citations'];
                            console.log('Citations for', paperId, ':', numCitations);
                            element.innerHTML = '| Citations: ' + numCitations;
                            element.style.color = '#333';
                        } else {
                            console.warn('Paper not found in data:', paperId);
                            element.innerHTML = '| Citations: 0';
                            element.style.color = '#999';
                        }
                    });
                })
                .fail(function (jqXHR, textStatus, errorThrown) {
                    console.error('Failed to load Google Scholar data:');
                    console.error('Status:', textStatus);
                    console.error('Error:', errorThrown);
                    
                    var citationEles = document.getElementsByClassName('show_paper_citations');
                    Array.prototype.forEach.call(citationEles, function(element) {
                        element.innerHTML = '| Citations: ERROR';
                        element.style.color = '#ff0000';
                    });
                });
        });
    </script>
</body>
</html> 